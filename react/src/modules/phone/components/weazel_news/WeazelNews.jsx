/* eslint-disable no-undef */
import React, {Component, Fragment} from 'react';
import {addAppDisplay, closeAppDisplay} from "../../actions/action.apps";
import {connect} from "react-redux";

class WeazelNews extends Component {
    constructor(props) {
        super(props);
        this.state = {
            message: ''
        };

        this.handleChangeMessage = this.handleChangeMessage.bind(this);
        this.sendMessage = this.sendMessage.bind(this);
    }

    handleChangeMessage(e) {
        this.setState({ message: e.target.value });
    }

    sendMessage() {
        const { message } = this.state;

        if (message) {
            this.setState({ message: '' });
            mp.trigger('callRemote', 'mapCase.news.ads.add', message);
        }
    }

    render() {
        const { message } = this.state;
        const { info, closeApp } = this.props;

        return (
            <Fragment>
                <div className="news_back">
                    <div className="news_logo">
                        <svg width="45%" height="45%" viewBox="0 0 109 49" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M28.7207 6.2L23.2247 23H19.0487L15.3527 11.624L11.5367 23H7.38472L1.86472 6.2H5.89672L9.68872 18.008L13.6487 6.2H17.2487L21.0887 18.104L25.0007 6.2H28.7207ZM43.4192 19.88V23H30.4112V6.2H43.1072V9.32H34.2752V12.968H42.0752V15.992H34.2752V19.88H43.4192ZM57.0968 19.4H49.2968L47.8088 23H43.8248L51.3128 6.2H55.1528L62.6648 23H58.5848L57.0968 19.4ZM55.8728 16.448L53.2088 10.016L50.5448 16.448H55.8728ZM77.5358 19.832V23H62.8478V20.48L72.0638 9.368H63.0398V6.2H77.1758V8.72L67.9838 19.832H77.5358ZM92.5573 19.88V23H79.5493V6.2H92.2453V9.32H83.4133V12.968H91.2133V15.992H83.4133V19.88H92.5573ZM95.1709 6.2H99.0589V19.832H107.483V23H95.1709V6.2Z" fill="white"/>
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M62 28.4242H0V48.0271H62V28.4242ZM16.9249 43.9713V32.6151H14.3086V39.51L8.61828 32.6151H6.42715V43.9713H9.04342V37.0765L14.7501 43.9713H16.9249ZM28.4956 43.9713V41.8623H22.2656V39.2342H27.5799V37.19H22.2656V34.7241H28.2831V32.6151H19.633V43.9713H28.4956ZM43.9992 43.9713L47.7437 32.6151H45.2092L42.5439 40.6618L39.9276 32.6151H37.4748L34.7768 40.5969L32.1933 32.6151H29.4462L33.2071 43.9713H36.0359L38.6358 36.2816L41.154 43.9713H43.9992ZM50.3507 43.8091C51.201 44.047 52.0786 44.166 52.9834 44.166C54.0299 44.166 54.9183 44.0092 55.6487 43.6955C56.3791 43.3819 56.9241 42.9601 57.2839 42.4301C57.6545 41.8893 57.8398 41.2945 57.8398 40.6456C57.8398 39.8885 57.6381 39.2882 57.2348 38.8448C56.8424 38.4014 56.3682 38.0769 55.8122 37.8714C55.2562 37.6659 54.5422 37.4604 53.6701 37.2549C52.8307 37.0711 52.2039 36.8872 51.7897 36.7034C51.3864 36.5087 51.1847 36.2167 51.1847 35.8273C51.1847 35.438 51.3591 35.1243 51.7079 34.8864C52.0677 34.6484 52.6182 34.5295 53.3595 34.5295C54.4169 34.5295 55.4743 34.8269 56.5317 35.4217L57.3493 33.4263C56.826 33.1018 56.2155 32.8531 55.5179 32.68C54.8202 32.507 54.1062 32.4205 53.3758 32.4205C52.3293 32.4205 51.4409 32.5773 50.7105 32.8909C49.991 33.2046 49.4514 33.6318 49.0917 34.1726C48.7319 34.7025 48.5521 35.2974 48.5521 35.9571C48.5521 36.7142 48.7483 37.3198 49.1407 37.7741C49.5441 38.2283 50.0237 38.5582 50.5797 38.7637C51.1356 38.9692 51.8497 39.1747 52.7217 39.3802C53.2886 39.5099 53.7355 39.6289 54.0626 39.7371C54.4005 39.8452 54.673 39.9912 54.8802 40.1751C55.0982 40.3481 55.2072 40.5699 55.2072 40.8402C55.2072 41.208 55.0273 41.5054 54.6676 41.7325C54.3078 41.9488 53.7519 42.057 52.9997 42.057C52.3239 42.057 51.648 41.9488 50.9721 41.7325C50.2962 41.5162 49.713 41.2296 49.2225 40.8727L48.3231 42.8519C48.8355 43.2413 49.5114 43.5603 50.3507 43.8091Z" fill="white"/>
                            <rect x="66" y="44.1065" width="43" height="3.92058" fill="white"/>
                            <rect x="66" y="36.2653" width="43" height="3.92058" fill="white"/>
                            <rect x="66" y="28.4242" width="43" height="3.92058" fill="white"/>
                        </svg>                    
                    </div>
                    <h2>Подача объявления</h2>
                    <div style={{ textAlign: 'center' }}>
                        <textarea 
                            className="news_input" 
                            placeholder="Введите текст объявления..."
                            maxLength="60"
                            rows="7"
                            value={message}
                            onChange={this.handleChangeMessage}
                        >
                        </textarea>
                    </div>
                    <span style={{ marginLeft: '5%' }}>{60 - message.length}/60 символов</span>
                    <span style={{ fontSize: '150%', position: 'absolute', margin: '2% 0 0 25%' }}>$ {info.symbolPriceNews * message.length}</span>

                    <div className="news_buttons_panel">
                        <div className="news_button_send" onClick={this.sendMessage}>
                            <svg width="25%" height="10%" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M33.9909 6.33785C33.9932 6.32426 33.9972 6.31067 33.9983 6.29709C34.0023 6.2552 33.9977 6.21274 33.9926 6.17029C33.9915 6.15953 33.9932 6.14934 33.9915 6.13858C33.9813 6.08254 33.9626 6.02763 33.9349 5.97499C33.9304 5.96593 33.9241 5.95744 33.919 5.94838C33.9179 5.94725 33.9179 5.94555 33.9174 5.94385C33.9168 5.94272 33.9151 5.94215 33.9145 5.94046C33.9106 5.93423 33.9072 5.92744 33.9032 5.92178C33.8681 5.87026 33.8256 5.82781 33.7781 5.79158C33.7673 5.78365 33.7549 5.77912 33.7436 5.77176C33.7017 5.74403 33.6575 5.72138 33.61 5.7061C33.589 5.69931 33.5681 5.69591 33.5466 5.69195C33.5052 5.68346 33.4639 5.67949 33.4209 5.68062C33.3983 5.68119 33.3767 5.68232 33.3541 5.68572C33.3394 5.68798 33.3252 5.68572 33.3105 5.68912L0.451733 12.4798C0.217941 12.5285 0.0390594 12.7182 0.00566054 12.9548C-0.0277383 13.1914 0.0905728 13.4235 0.301721 13.535L9.71679 18.5012L11.3681 27.6644C11.3669 27.6712 11.3686 27.6786 11.3681 27.6854C11.3624 27.7306 11.3618 27.7748 11.3675 27.8195C11.3703 27.8422 11.3731 27.8637 11.3788 27.8857C11.3918 27.9395 11.4128 27.9899 11.4411 28.0375C11.4467 28.0465 11.4467 28.0573 11.453 28.0663C11.4547 28.0692 11.4575 28.0714 11.4598 28.0737C11.4671 28.0844 11.4773 28.0929 11.4858 28.1037C11.5124 28.1365 11.5401 28.1665 11.5718 28.192C11.5769 28.196 11.5803 28.2022 11.586 28.2061C11.5945 28.2124 11.6041 28.2141 11.6126 28.2197C11.6471 28.2424 11.6828 28.2611 11.7207 28.2758C11.736 28.2814 11.7502 28.2882 11.766 28.2928C11.817 28.3075 11.8696 28.3177 11.9228 28.3177C11.9234 28.3177 11.9239 28.3177 11.9245 28.3177C11.9268 28.3177 11.929 28.3165 11.9313 28.3165C11.9409 28.3171 11.9506 28.3177 11.9602 28.3177C12.117 28.3177 12.2585 28.2475 12.3632 28.1394L18.6348 23.9583L25.2014 28.2265C25.2942 28.2865 25.4018 28.3177 25.5099 28.3177C25.5693 28.3177 25.6299 28.308 25.6882 28.2888C25.8513 28.2345 25.9815 28.1088 26.0409 27.9469L33.9638 6.442C33.9711 6.42276 33.9774 6.40294 33.9824 6.38257C33.9847 6.37407 33.9853 6.36558 33.987 6.35766C33.9887 6.35143 33.9898 6.34464 33.9909 6.33785ZM27.4346 9.95115L13.8526 19.9374C13.8305 19.9538 13.813 19.9742 13.7937 19.9934C13.7864 20.0002 13.779 20.0059 13.7728 20.0132C13.7609 20.0263 13.7501 20.0393 13.7394 20.0534C13.7292 20.067 13.7213 20.0812 13.7122 20.0953C13.6913 20.1293 13.6737 20.1644 13.6601 20.2018C13.6573 20.2091 13.6528 20.2148 13.6505 20.2221C13.6499 20.2244 13.6477 20.2255 13.6471 20.2278L12.0904 25.2869L10.8569 18.4424L27.4346 9.95115ZM12.9678 26.376L14.5109 21.279L16.9134 22.8408L17.6006 23.2875L15.2661 24.8436L12.9678 26.376ZM29.4612 7.64097L10.2297 17.4914L2.22527 13.2695L29.4612 7.64097ZM25.224 26.8911L16.5035 21.2235L15.1829 20.3648L32.2525 7.81362L25.224 26.8911Z" fill="#BC0C0C"/>
                            </svg>
                        </div>
                        <div className="news_button_back" onClick={closeApp}>
                            <svg width="60%" height="10%" viewBox="0 0 34 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g clip-path="url(#clip0)">
                                    <path d="M25.5553 11.9995C25.509 11.9995 2.39733 11.9995 2.39733 11.9995L7.26663 6.5418C7.58239 6.18786 7.55145 5.64499 7.1975 5.32922C6.84369 5.01353 6.30069 5.04434 5.98493 5.39835L0.500974 11.5449C-0.167005 12.2938 -0.166939 13.423 0.501041 14.1717L5.98499 20.3184C6.15473 20.5086 6.38987 20.6054 6.62608 20.6054C6.82955 20.6054 7.03374 20.5335 7.19757 20.3875C7.55151 20.0717 7.58239 19.5289 7.2667 19.1749L2.3974 13.7171C2.3974 13.7171 25.509 13.7171 25.5554 13.7171C29.2647 13.7171 32.2824 16.7349 32.2824 20.4441C32.2824 24.1532 29.2647 27.171 25.5554 27.171H21.4661C20.9918 27.171 20.6073 27.5556 20.6073 28.0298C20.6073 28.5041 20.9918 28.8887 21.4661 28.8887H25.5554C30.2118 28.8887 34 25.1005 34 20.4441C33.9999 15.7877 30.2117 11.9995 25.5553 11.9995Z" fill="black"/>
                                </g>
                            </svg>
                        </div>
                    </div>
                </div>
            </Fragment>
        );
    }
}

const mapStateToProps = state => ({
    info: state.info
});

const mapDispatchToProps = dispatch => ({
    addApp: app => dispatch(addAppDisplay(app)),
    closeApp: () => dispatch(closeAppDisplay()),
});

export default connect(mapStateToProps, mapDispatchToProps)(WeazelNews);